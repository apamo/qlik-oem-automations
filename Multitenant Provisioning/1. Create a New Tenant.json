{"blocks":[{"id":"B1200228-CB4D-4C77-8D40-4127E39DFE24","type":"StartBlock","disabled":false,"name":"Start","displayName":"Start","comment":"","childId":"0E52A018-982D-4768-B75C-7A2986EA16FA","inputs":[{"id":"run_mode","value":"manual","type":"select","structure":{}}],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-4970,"y":-648},{"id":"5637A9BE-C58A-4D7C-8D84-76F1E806C534","type":"EndpointBlock","disabled":false,"name":"GetLicenseOverview","displayName":"Qlik Platform Operations - Get License Overview","comment":"","childId":"CB42A303-0D87-420A-84A9-C9870215274C","inputs":[{"id":"6ee8e9c0-9d78-11ed-9bc8-9be121ac3db0","value":"{ $.sourceTenant }","type":"string","structure":[]}],"settings":[{"id":"datasource","value":"362c212a-10ba-4864-b435-14a6fca80512","type":"select","structure":[]},{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"cache","value":"0","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-4970,"y":-48,"datasourcetype_guid":"c7e48240-e0f2-11ec-ada1-d5ef75014b77","endpoint_guid":"6ea9fa20-9d78-11ed-a228-a3d1b7dd2e0f","endpoint_role":"get"},{"id":"CB42A303-0D87-420A-84A9-C9870215274C","type":"EndpointBlock","disabled":false,"name":"createTenant","displayName":"Qlik Platform Operations - Create Tenant","comment":"","childId":"E6B88885-55AE-48B1-A24E-6DE2D22CF933","inputs":[{"id":"349488c0-98c7-11ed-a36c-d756b982108d","value":"{ $.tenantRegion }","type":"string","structure":[]},{"id":"804e0d80-eaff-11ec-9d3c-27c65d22b2cd","value":"{$.GetLicenseOverview.licenseKey}","type":"string","structure":[]}],"settings":[{"id":"datasource","value":"362c212a-10ba-4864-b435-14a6fca80512","type":"select","structure":[]},{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-1675,"y":250,"datasourcetype_guid":"c7e48240-e0f2-11ec-ada1-d5ef75014b77","endpoint_guid":"dda61e00-e0f2-11ec-a33b-895d4cdc49ef","endpoint_role":"create"},{"id":"2B36F23F-8E90-4963-B3A4-7098ED60C9C9","type":"ShowBlock","disabled":false,"name":"output","displayName":"Output","comment":"End of 'Create a new tenant' flow","childId":"858D760B-194C-49A1-8DC2-1F054D9472B3","inputs":[{"id":"input","value":"{ $.createTenant }","type":"string","structure":[]}],"settings":[{"id":"display_mode","value":"add","type":"select","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-2033,"y":491},{"id":"58692171-25C7-4BCD-B241-73B10E71D0A4","type":"SnippetBlock","disabled":false,"name":"GetStraightTableData","displayName":"Qlik Cloud Services - Get Straight Table Data","comment":"","childId":null,"inputs":[{"id":"702aa990-e7d6-11ea-9155-5563fc8a0200","value":null,"type":"string","structure":[]},{"id":"5295ea90-1fa5-11eb-8b61-a1195c91b158","value":null,"type":"string","structure":[]},{"id":"702b4760-e7d6-11ea-bd24-c3ad734592ce","value":null,"type":"string","structure":[]}],"settings":[{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-1277,"y":-209,"loopBlockId":null,"datasourcetype_guid":"61a87510-c7a3-11ea-95da-0fb0c241e75c","snippet_guid":"70247640-e7d6-11ea-b140-a1d938943465"},{"id":"D3F4B45C-5803-4585-A13F-F9150562D5CA","type":"EndpointBlock","disabled":false,"name":"CreatePinnedLink","displayName":"Qlik Cloud Services - Create Pinned Link","comment":"Store new Tenant URL as a link in the global navigation menu","childId":"95673F1B-2C43-4487-B31E-8BE2421122E8","inputs":[{"id":"b28b3c40-ef99-11ef-a4f9-a13c6b9bf079","value":"{ $.inputs.'Customer Name' }","type":"string","structure":[]},{"id":"fd73e080-ef99-11ef-b743-a35bb4e9404d","value":"https://{ $.targetTenant }","type":"string","structure":[]}],"settings":[{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-2033,"y":611,"datasourcetype_guid":"61a87510-c7a3-11ea-95da-0fb0c241e75c","endpoint_guid":"b23222a0-ef99-11ef-a777-857845ed71ef","endpoint_role":"create"},{"id":"0BB58793-1F81-40CD-AF80-DD84B4D732F5","type":"EndpointBlock","disabled":false,"name":"createTerm","displayName":"Qlik Cloud Services - Create Term","comment":"Store as a business term in the Glossary the following info: customer name, new tenant URL and AppId of the template app to be deployed to this specific customer","childId":"2B36F23F-8E90-4963-B3A4-7098ED60C9C9","inputs":[{"id":"8253b200-5630-11ee-b2fd-350e5f792573","value":"{ $.filterList[0].id }","type":"string","structure":[]},{"id":"c58d35e0-5630-11ee-a6e7-db6b6498f098","value":"{ $.inputs.'Customer Name' }","type":"string","structure":[]},{"id":"dda04000-5630-11ee-befb-8fbf9676df42","value":null,"type":"string","structure":[]},{"id":"f0683590-5630-11ee-bc41-87f09bdb7cb1","value":"{ $.targetTenant }","type":"string","structure":[]},{"id":"fc259e70-5630-11ee-a52f-1fa41edbebb5","value":"{uppercase: { substr: { $.inputs.'Customer Name' }, 0, 3 }}","type":"string","structure":[]},{"id":"0dc39800-5631-11ee-be4f-83abc7829d44","value":"[\"e70404f6-3647-4ce0-b33d-064bb1473a10\"]","type":"string","structure":[]},{"id":"2030ec50-5631-11ee-9c17-45161d913a0d","value":null,"type":"string","structure":[]},{"id":"30788ec0-5631-11ee-a358-ffcea70b8008","value":null,"type":"string","structure":[]},{"id":"3fe038d0-5631-11ee-9cc0-4d24c1965989","value":null,"type":"string","structure":[]},{"id":"4980a610-5631-11ee-8f70-9764de6e36dd","value":null,"type":"string","structure":[]}],"settings":[{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-1968,"y":262,"datasourcetype_guid":"61a87510-c7a3-11ea-95da-0fb0c241e75c","endpoint_guid":"82432160-5630-11ee-b2f4-3b97c6c1c76e","endpoint_role":"create"},{"id":"0E52A018-982D-4768-B75C-7A2986EA16FA","type":"FormBlock","disabled":false,"name":"inputs","displayName":"Inputs","comment":"Prompts the user to enter a customer name","childId":"C0654BD1-11C5-45FD-8062-D0A930146D21","inputs":[],"settings":[{"id":"persist_data","value":"no","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-2503,"y":55,"form":[{"id":"inputs-input-0","type":"input","label":"Customer Name","order":0,"values":null,"options":[],"helpText":"Used to create the tenant in Qlik Cloud. Ensure correct spelling.","isRequired":true},{"id":"inputs-input-1","type":"input","label":"Source Tenant URL","order":1,"values":null,"options":[],"helpText":"<TENANT_NAME>.<TENANT_REGION>.qlikcloud.com","isRequired":true}],"persistData":"no"},{"id":"858D760B-194C-49A1-8DC2-1F054D9472B3","type":"EndpointBlock","disabled":false,"name":"listUsers","displayName":"Qlik Platform Operations - List Users","comment":"Obtain the user subject by email on the source tenant","childId":"A3645269-0F12-42A4-84E9-BE1454E805FE","inputs":[{"id":"447b9eb0-7634-11ed-a9df-a788128e422e","value":"{ $.sourceTenant }","type":"string","structure":[]},{"id":"eb56ff20-9ca8-11ed-82cb-752b6b37b1a7","value":"email eq \"alvaro.palacios@qlik.com\"","type":"string","structure":[]}],"settings":[{"id":"datasource","value":"362c212a-10ba-4864-b435-14a6fca80512","type":"select","structure":[]},{"id":"maxitemcount","value":"","type":"string","structure":[]},{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"cache","value":"0","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":true}],"x":-2070,"y":709,"loopBlockId":null,"datasourcetype_guid":"c7e48240-e0f2-11ec-ada1-d5ef75014b77","endpoint_guid":"445157c0-7634-11ed-9b40-9720b0f37135","endpoint_role":"list"},{"id":"A3645269-0F12-42A4-84E9-BE1454E805FE","type":"EndpointBlock","disabled":false,"name":"listRoles","displayName":"Qlik Platform Operations - List Roles","comment":"Obtaint the ID for TenantAdmin role on the new tenant","childId":"82721444-73FC-4E7B-840A-96F07A9CDF98","inputs":[{"id":"bae46270-b76f-11ed-a52b-d71383a5b940","value":"{ $.targetTenant }","type":"string","structure":[]},{"id":"35bbb150-b77a-11ed-9a99-9b0cd6b2a9ab","value":"name eq \"TenantAdmin\"","type":"string","structure":[]}],"settings":[{"id":"datasource","value":"362c212a-10ba-4864-b435-14a6fca80512","type":"select","structure":[]},{"id":"maxitemcount","value":"","type":"string","structure":[]},{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"cache","value":"0","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":true}],"x":-3619,"y":920,"loopBlockId":null,"datasourcetype_guid":"c7e48240-e0f2-11ec-ada1-d5ef75014b77","endpoint_guid":"ba493570-b76f-11ed-b6ab-6fd465c15105","endpoint_role":"list"},{"id":"BFC8379F-106E-4104-83BA-518F2DBE9097","type":"EndpointBlock","disabled":false,"name":"createUser","displayName":"Qlik Platform Operations - Create User","comment":"Add the user to the target tenant as a TenantAdmin","childId":"264E16C8-7531-476A-AD9C-F3804B67DB88","inputs":[{"id":"6c07a470-44c9-11ed-81ec-2dfd98774628","value":"{ $.targetTenant }","type":"string","structure":[]},{"id":"6beaed10-44c9-11ed-9f5a-2de80bbba99e","value":"{$.listUsers[0].name}","type":"string","structure":[]},{"id":"ca85a980-b9c0-11ed-823f-0315a7948c75","value":"{$.listUsers[0].email}","type":"string","structure":[]},{"id":"4410c760-44ca-11ed-b584-69b354d9bb1f","value":"{ $.listUsers[0].subject }","type":"string","structure":[]},{"id":"32d487a0-44ca-11ed-842e-55c135bb046d","value":"{json: { $.transformList }}","type":"string","structure":[]}],"settings":[{"id":"datasource","value":"362c212a-10ba-4864-b435-14a6fca80512","type":"select","structure":[]},{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":792,"y":662,"datasourcetype_guid":"c7e48240-e0f2-11ec-ada1-d5ef75014b77","endpoint_guid":"6bd82bf0-44c9-11ed-80c7-0507c09f13f9","endpoint_role":"create"},{"id":"82721444-73FC-4E7B-840A-96F07A9CDF98","type":"TransformListBlock","disabled":false,"name":"transformList","displayName":"Transform List","comment":"Mapping the role ID to a new list","childId":"BFC8379F-106E-4104-83BA-518F2DBE9097","inputs":[{"id":"list","value":"{ $.listRoles }","type":"string","structure":[]},{"id":"mapping","value":[{"key":"id","value":"{ $.transformList.item.id }"}],"type":"object","mode":"keyValue","structure":[]}],"settings":[{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":true}],"x":-238,"y":573,"loopBlockId":null},{"id":"264E16C8-7531-476A-AD9C-F3804B67DB88","type":"ShowBlock","disabled":false,"name":"output2","displayName":"Output 2","comment":"End of 'Add user to a tenant' flow","childId":"7D9595D5-F7A1-4F2C-B13A-D5E5FAEEE2FF","inputs":[{"id":"input","value":"{ $.createUser }","type":"string","structure":[]}],"settings":[{"id":"display_mode","value":"add","type":"select","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-307,"y":711},{"id":"C0654BD1-11C5-45FD-8062-D0A930146D21","type":"VariableBlock","disabled":false,"name":"sourceTenant","displayName":"Variable - sourceTenant","comment":"Store source tenant URL","childId":"E4D7E2BD-B963-4AB4-8342-7468CF655758","inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-3413,"y":-189,"variableGuid":"5A6832AF-4997-4D4F-ADEB-88821E2BFFC8","operations":[{"id":"empty","key":"0B4F6636-C10A-45F4-86C6-EB2CF7256027","name":"Empty { variable }","value":null},{"id":"set_value","key":"9AFF386D-7004-49BC-AC6E-0C5D1E2D3784","name":"Set value of { variable }","value":"{ $.inputs.'Source Tenant URL' }"}]},{"id":"E4D7E2BD-B963-4AB4-8342-7468CF655758","type":"VariableBlock","disabled":false,"name":"tenantRegion","displayName":"Variable - tenantRegion","comment":"Store tenant region information","childId":"2148A425-48C2-4F6A-8F64-A7AFCF2F63F4","inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-4118,"y":-239,"variableGuid":"D89FC00D-BFA0-41F2-B220-96235C8B2202","operations":[{"id":"empty","key":"7FFA9F86-B9CA-419D-BA42-2AC5AB7F3781","name":"Empty { variable }","value":null},{"id":"set_value","key":"3F4D796D-0E87-4954-9EAE-5E05F3D31E35","name":"Set value of { variable }","value":"{ substr: { $.inputs.'Source Tenant URL' }, { add: {strpos: { $.inputs.'Source Tenant URL' }, '.'}, 1 }, 2 }"}]},{"id":"E6B88885-55AE-48B1-A24E-6DE2D22CF933","type":"VariableBlock","disabled":false,"name":"targetTenant","displayName":"Variable - targetTenant","comment":"Store target tenant URL","childId":"D3F4B45C-5803-4585-A13F-F9150562D5CA","inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-4556,"y":133,"variableGuid":"600835CB-6459-452B-8B60-C57E46E51B6D","operations":[{"id":"empty","key":"0F4FD983-7AB6-40D7-B898-92CC59F8217C","name":"Empty { variable }","value":null},{"id":"set_value","key":"A602DDAE-8BF6-4C57-9DBF-26B992CEA9A1","name":"Set value of { variable }","value":"{$.createTenant.name}.{$.createTenant.region}.qlikcloud.com"}]},{"id":"7D9595D5-F7A1-4F2C-B13A-D5E5FAEEE2FF","type":"CallWidgetBlock","disabled":false,"name":"callAutomation","displayName":"2. Configure a New Tenant - Call Automation","comment":"","childId":null,"inputs":[{"id":"guid","value":"0571a789-bdf4-4c49-ba3f-7d6d3d5d9d55","type":"api-search","displayValue":"2. Configure a New Tenant","structure":[]},{"id":"widgetInputs","value":[{"key":"Source Tenant URL","value":"{ $.sourceTenant }"},{"key":"Target Tenant URL","value":"{$.targetTenant}"}],"type":"object","mode":"keyValue","structure":[]}],"settings":[{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"cache","value":null,"type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-4790,"y":1300},{"id":"2148A425-48C2-4F6A-8F64-A7AFCF2F63F4","type":"VariableBlock","disabled":false,"name":"businessGlossary","displayName":"Variable - businessGlossary","comment":"Store name of the glossary containing the ISV Configuration Database","childId":"5637A9BE-C58A-4D7C-8D84-76F1E806C534","inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-5857,"y":-325,"variableGuid":"27D85D24-E66D-4331-A284-34AC4241015E","operations":[{"id":"empty","key":"AC8420DF-A606-480F-A4A5-E26CE253D233","name":"Empty { variable }","value":null},{"id":"set_value","key":"550B0217-1494-4022-8062-D1AD5E9F1E01","name":"Set value of { variable }","value":"ISV Configuration Database"}]},{"id":"95673F1B-2C43-4487-B31E-8BE2421122E8","type":"EndpointBlock","disabled":false,"name":"listGlossaries","displayName":"Qlik Cloud Services - List Glossaries","comment":"Get glossaries on the source tenant","childId":"537F52FF-6156-4196-8351-C1E52105AACD","inputs":[],"settings":[{"id":"maxitemcount","value":"","type":"string","structure":[]},{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"cache","value":"0","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":true}],"x":-4493,"y":66,"loopBlockId":null,"datasourcetype_guid":"61a87510-c7a3-11ea-95da-0fb0c241e75c","endpoint_guid":"df689160-53bc-11ee-b8e0-4d2494612b78","endpoint_role":"list"},{"id":"537F52FF-6156-4196-8351-C1E52105AACD","type":"FilterListBlock","disabled":false,"name":"filterList","displayName":"Filter over Qlik Cloud Services - List Glossaries - Filter List","comment":"Obtain the glossary that serves as ISV Configuration Database","childId":"0BB58793-1F81-40CD-AF80-DD84B4D732F5","inputs":[{"id":"list","value":"{ $.listGlossaries }","type":"string","structure":[]},{"id":"conditions","value":{"mode":"all","conditions":[{"input1":"name","input2":"{ $.businessGlossary }","operator":"="}]},"type":"custom","structure":[]}],"settings":[{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":true}],"x":-5666,"y":200,"loopBlockId":null}],"variables":[{"guid":"5A6832AF-4997-4D4F-ADEB-88821E2BFFC8","name":"sourceTenant","type":"string"},{"guid":"D89FC00D-BFA0-41F2-B220-96235C8B2202","name":"tenantRegion","type":"string"},{"guid":"600835CB-6459-452B-8B60-C57E46E51B6D","name":"targetTenant","type":"string"},{"guid":"27D85D24-E66D-4331-A284-34AC4241015E","name":"businessGlossary","type":"string"}]}