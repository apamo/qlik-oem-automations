{"blocks":[{"id":"722D56C7-BEFE-46F4-98A5-5500228D2E51","type":"StartBlock","disabled":false,"name":"Start","displayName":"Start","comment":"","childId":"528F86A4-12A9-4252-9920-E8FB337518E9","inputs":[{"id":"run_mode","value":"manual","type":"select","structure":{}}],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-427,"y":-50},{"id":"7C23F04E-7FAE-452C-A3E0-1EC95B92781B","type":"SnippetBlock","disabled":false,"name":"GetStraightTableData","displayName":"Qlik Cloud Services - Get Straight Table Data","comment":"Object from existing Qlik app","childId":"292AEFB7-FDEA-40B8-860F-7199737405D8","inputs":[{"id":"702aa990-e7d6-11ea-9155-5563fc8a0200","value":"435a2cfd-eb8b-425c-8308-9d36594ffd88","type":"string","displayValue":"Customer Dashboard (435a2cfd-eb8b-425c-8308-9d36594ffd88)","structure":[]},{"id":"5295ea90-1fa5-11eb-8b61-a1195c91b158","value":"32682531-655b-4870-babd-4c2f7cbd6834","type":"string","displayValue":"Customer Overview","structure":[]},{"id":"702b4760-e7d6-11ea-bd24-c3ad734592ce","value":"kWPfSpJ","type":"string","displayValue":"kWPfSpJ - auto-chart - row 2 col 12","structure":[]}],"settings":[{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":8,"y":396,"loopBlockId":"388BE69F-BB3C-4321-A3D5-7D448FAB4413","datasourcetype_guid":"61a87510-c7a3-11ea-95da-0fb0c241e75c","snippet_guid":"70247640-e7d6-11ea-b140-a1d938943465"},{"id":"D2CAA88A-3386-497F-8008-3B1EEE4716AB","type":"SnippetBlock","disabled":false,"name":"getMeasureValue","displayName":"Qlik Cloud Services - Get Measure Value","comment":"Object from existing Qlik app","childId":"1FB52559-1897-41FF-ABD6-32E07020D113","inputs":[{"id":"7fd1a6b0-04b1-11ec-bf03-790adec74209","value":"435a2cfd-eb8b-425c-8308-9d36594ffd88","type":"string","displayValue":"Customer Dashboard (435a2cfd-eb8b-425c-8308-9d36594ffd88)","structure":[]},{"id":"bcfddcf0-04b7-11ec-8852-cfe6ca106bb5","value":"mpZMHZs","type":"string","displayValue":"Total Sales €","structure":[]},{"id":"24bfed00-76ef-11ed-99c0-7b1dab501875","value":null,"type":"select","structure":[]}],"settings":[{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-364,"y":260,"datasourcetype_guid":"61a87510-c7a3-11ea-95da-0fb0c241e75c","snippet_guid":"7fc83720-04b1-11ec-8bd4-7fc20db0a174"},{"id":"E79C5D27-A688-4333-9287-1004172DC9B4","type":"EndpointBlock","disabled":false,"name":"SendMail","displayName":"Mail - Send Mail","comment":"Send HTML report based on Straight Table (vHTMLBody) and Measure value","childId":null,"inputs":[{"id":"442845a0-cd00-11eb-9aa5-b966a68573b7","value":"{implode: {$.recipients}, ';'}","type":"string","structure":[]},{"id":"543f08c0-cd00-11eb-b9c6-af8e23cc2439","value":null,"type":"string","structure":[]},{"id":"5cbdb1d0-cd00-11eb-8afd-ddd4ecc002ac","value":null,"type":"string","structure":[]},{"id":"72cad1e0-cd00-11eb-aa1b-3f42c1d22e38","value":"HTML Report {date: 'now', 'd-m-y'}","type":"string","structure":[]},{"id":"79af8c50-cd24-11eb-a019-dfdc9a7f7317","value":"90ff46f0-cd24-11eb-bda1-0f1c7c213bfb","type":"select","displayValue":"html","structure":[]},{"id":"7d225d00-cd00-11eb-8493-055760e8b45a","value":"<br><br>\nExample of emailed report in html format:\n<br><br>\n1. Measure value: {$.getMeasureValue}\n<br><br>\n2. Straight Table:\n<br><br>\n{$.vHtmlBody}\n<br><br><br>\n<h1 style=\"color:#009845;font-family:Inter;font-size:14px\">Alvaro Palacios (He/Him)</h1><p style=\"font-size:12px;font-family:Inter;font-size:12px\">Sr. Solutions Architect, Embedded Analytics</p><p style=\"color:#006580;font-family:Inter;font-size:12px\">Alvaro.Palacios@qlik.com  |  <u>qlik.com</u></p><p style=\"font-family:Inter;font-size:12px\">+34 697-737-447</p><p style=\"font-family:Inter;font-size:12px\">Barcelona, Spain  |  CET time zone</p><br><br>\n<img src=\"https://res.cloudinary.com/talend/image/upload/w_70/q_auto/qlik/logos/logo-qlik-footer_u8pwnu.svg\">","type":"longtext","structure":[]},{"id":"bb841f10-3341-11ec-b9a3-9d6de0bb7866","value":null,"type":"custom","structure":[]}],"settings":[{"id":"datasource","value":"990e8ae0-2776-11ed-ac11-3d1f8e55ce47","type":"select","displayValue":"Mail","structure":[]},{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":124,"y":1353,"datasourcetype_guid":"05407a80-ccfd-11eb-b098-7140f6ac27f4","endpoint_guid":"84a79bf0-ccff-11eb-a508-7d415a725ea7","endpoint_role":"create"},{"id":"3745FA4D-AA22-44D4-A0F2-6FFCA9AE7457","type":"VariableBlock","disabled":false,"name":"vTableHeaders","displayName":"Variable - vTableHeaders","comment":"Get header names from straight table","childId":"9DDAB3F6-590D-42AE-AB23-ADBFCBC3EB04","inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":120,"y":700,"variableGuid":"DCBE28CE-2BCF-452C-84E6-627324B32C9C","operations":[{"id":"set_value","key":"86E8036E-5B2E-486B-A6F1-62BF2AD4897F","name":"Set value of { variable }","value":"{getkeys: {$.GetStraightTableData.item}}"}]},{"id":"1FB52559-1897-41FF-ABD6-32E07020D113","type":"VariableBlock","disabled":false,"name":"vLoop","displayName":"Variable - vLoop","comment":"This variable controls the next loop. Used to find the first iteration","childId":"7C23F04E-7FAE-452C-A3E0-1EC95B92781B","inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-455,"y":221,"variableGuid":"4A2B90BD-6F3D-435F-ABA1-B11401D543C0","operations":[{"id":"set_value","key":"D60B3966-7BAD-4980-816C-DE6FEA98ABE2","name":"Set value of { variable }","value":"1"}]},{"id":"388BE69F-BB3C-4321-A3D5-7D448FAB4413","type":"IfElseBlock","disabled":false,"name":"condition","displayName":"Condition","comment":"Check if first iteration in Loop","childId":"5BDBDB3E-F819-43F4-8C97-93876E2E8A83","inputs":[{"id":"conditions","value":{"mode":"all","conditions":[{"input1":"{$.vLoop}","input2":"1","operator":"="}]},"type":"custom","structure":[]}],"settings":[],"collapsed":[{"name":"both","isCollapsed":false},{"name":"yes","isCollapsed":false},{"name":"no","isCollapsed":true}],"x":-487,"y":226,"childTrueId":"3745FA4D-AA22-44D4-A0F2-6FFCA9AE7457","childFalseId":null},{"id":"9DDAB3F6-590D-42AE-AB23-ADBFCBC3EB04","type":"ForEachBlock","disabled":false,"name":"loop","displayName":"Loop","comment":"Iterate over the previous list with header names","childId":"1EDE75D6-3683-4823-8E58-2564201FE42F","inputs":[{"id":"input","value":"{$.vTableHeaders}","type":"string","structure":[]}],"settings":[{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-490,"y":581,"loopBlockId":"1995A1C5-30C9-4B9F-AA34-2BEE24153BC2"},{"id":"F2859781-86D8-4862-8BC1-6D7DA7036ABD","type":"VariableBlock","disabled":false,"name":"vLoop","displayName":"Variable - vLoop","comment":"Increase variable value so next evaluation of condition block is false","childId":null,"inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-8,"y":1081,"variableGuid":"4A2B90BD-6F3D-435F-ABA1-B11401D543C0","operations":[{"id":"add","key":"E31500DA-F729-4179-8D4B-A0B07EEEC9DF","name":"Add to { variable }","value":"1"}]},{"id":"1995A1C5-30C9-4B9F-AA34-2BEE24153BC2","type":"VariableBlock","disabled":false,"name":"vTH","displayName":"Variable - vTH","comment":"HTML tags for table headers <th></th>","childId":null,"inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-461,"y":632,"variableGuid":"E9AD0659-BA70-49ED-8D6C-42A1DCD64E55","operations":[{"id":"append","key":"3CA56F9A-1121-4BE3-AE5E-BB7224F6D04D","name":"Append to { variable }","value":"<th>{$.loop.item}</th>"}]},{"id":"1EDE75D6-3683-4823-8E58-2564201FE42F","type":"VariableBlock","disabled":false,"name":"vTH","displayName":"Variable - vTH","comment":"Wrap tables headers between table row <tr></tr>","childId":"F2859781-86D8-4862-8BC1-6D7DA7036ABD","inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-850,"y":655,"variableGuid":"E9AD0659-BA70-49ED-8D6C-42A1DCD64E55","operations":[{"id":"set_value","key":"B17E698C-4A61-485C-ACD8-1862EC6CCFE2","name":"Set value of { variable }","value":"<tr>{$.vTH}</tr>"}]},{"id":"00E28DB4-6FE4-4DA2-B33A-229B5BF57BEC","type":"VariableBlock","disabled":false,"name":"vTD","displayName":"Variable - vTD","comment":"Form the table data <td></td>","childId":null,"inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":128,"y":1147,"variableGuid":"5D78B215-ED57-41A6-BEDC-FDBBA82ED47E","operations":[{"id":"append","key":"4A339022-F3CD-493B-B857-9D7082810CC2","name":"Append to { variable }","value":"<td>{$.loop2.item}</td>"}]},{"id":"5BDBDB3E-F819-43F4-8C97-93876E2E8A83","type":"ForEachBlock","disabled":false,"name":"loop2","displayName":"Loop 2","comment":"For each item (row values) loop over","childId":"1D285EF8-10BD-447F-BB4D-C9EC98D5190D","inputs":[{"id":"input","value":"{$.GetStraightTableData.item}","type":"string","structure":[]}],"settings":[{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-923,"y":1037,"loopBlockId":"00E28DB4-6FE4-4DA2-B33A-229B5BF57BEC"},{"id":"292AEFB7-FDEA-40B8-860F-7199737405D8","type":"VariableBlock","disabled":false,"name":"vHtmlBody","displayName":"Variable - vHtmlBody","comment":"Wrap table headers and table rows between <table></table> html tags","childId":"E79C5D27-A688-4333-9287-1004172DC9B4","inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-849,"y":1175,"variableGuid":"BBF0C406-3DAB-4987-8E3F-F46A2187BB6F","operations":[{"id":"set_value","key":"1E6E3269-4DA3-432D-9076-29432542DB9A","name":"Set value of { variable }","value":"<table>{$.vTH}{$.vTR}</table>"}]},{"id":"528F86A4-12A9-4252-9920-E8FB337518E9","type":"VariableBlock","disabled":false,"name":"recipients","displayName":"Variable - recipients","comment":"Add email addresses to create the list of recipients. Use the Implode formula in the Send Mail block to transform the list into a string of addresses separated by semicolons.","childId":"D2CAA88A-3386-497F-8008-3B1EEE4716AB","inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":18,"y":-69,"variableGuid":"45EC504E-0B39-4482-8046-A88ACE83D79D","operations":[{"id":"empty","key":"6ED1309C-9C6F-43B5-A5FD-C4555B853C98","name":"Empty { variable }"},{"id":"add_item","key":"DE375E6C-B93C-4083-8D92-5415D1A25046","name":"Add item to { variable }","value":"alp@qlik.com"}]},{"id":"1D285EF8-10BD-447F-BB4D-C9EC98D5190D","type":"VariableBlock","disabled":false,"name":"vTR","displayName":"Variable - vTR","comment":"Wrap the table data in vTD between table row <tr></tr>","childId":"7A497137-5FFC-4E6C-AABE-FF94105B4EA6","inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-187,"y":1490,"variableGuid":"17CD4EF3-3D80-4A56-AFDD-3A72A1AD94AF","operations":[{"key":"658F5BC9-0C55-447F-A6F8-3B519499F9BB","id":"append","name":"Append to { variable }","value":"<tr>{$.vTD}</tr>"}]},{"id":"7A497137-5FFC-4E6C-AABE-FF94105B4EA6","type":"VariableBlock","disabled":false,"name":"vTD","displayName":"Variable - vTD","comment":"Empty the vTD variable for the next iteration (next row values)","childId":null,"inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-857,"y":1373,"variableGuid":"5D78B215-ED57-41A6-BEDC-FDBBA82ED47E","operations":[{"key":"B3B7801B-EAA3-4C73-BB72-010055C340D4","id":"empty","name":"Empty { variable }"}]}],"variables":[{"guid":"BBF0C406-3DAB-4987-8E3F-F46A2187BB6F","name":"vHtmlBody","type":"string"},{"guid":"E9AD0659-BA70-49ED-8D6C-42A1DCD64E55","name":"vTH","type":"string"},{"guid":"4A2B90BD-6F3D-435F-ABA1-B11401D543C0","name":"vLoop","type":"number"},{"guid":"DCBE28CE-2BCF-452C-84E6-627324B32C9C","name":"vTableHeaders","type":"string"},{"guid":"5D78B215-ED57-41A6-BEDC-FDBBA82ED47E","name":"vTD","type":"string"},{"guid":"45EC504E-0B39-4482-8046-A88ACE83D79D","name":"recipients","type":"list"},{"guid":"17CD4EF3-3D80-4A56-AFDD-3A72A1AD94AF","name":"vTR","type":"string"}]}